name: Test Environment Variables

on:
  workflow_dispatch:

jobs:
  test_env:
    runs-on: ubuntu-latest
    environment: production
    
    steps:
      - name: Test Environment Variables
        env:
          METACULUS_TOKEN: ${{ secrets.METACULUS_TOKEN }}
          OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
        run: |
          echo "ğŸ” Testing Environment Variables"
          echo "=========================="
          
          echo "METACULUS_TOKEN:"
          if [ -z "$METACULUS_TOKEN" ]; then
            echo "  âŒ METACULUS_TOKEN is not set!"
            echo "  ğŸ“ This is the main issue - tournament cannot run without it"
          else
            echo "  âœ… METACULUS_TOKEN is set"
            echo "  ğŸ“ Length: ${#METACULUS_TOKEN} characters"
          fi
          
          echo ""
          echo "OPENROUTER_API_KEY:"
          if [ -z "$OPENROUTER_API_KEY" ]; then
            echo "  âŒ OPENROUTER_API_KEY is not set!"
            echo "  ğŸ“ This may cause issues but tournament might still run"
          else
            echo "  âœ… OPENROUTER_API_KEY is set"
            echo "  ğŸ“ Length: ${#OPENROUTER_API_KEY} characters"
          fi
          
          echo ""
          echo "Environment Status:"
          if [ -n "$METACULUS_TOKEN" ] && [ -n "$OPENROUTER_API_KEY" ]; then
            echo "  âœ… Both critical environment variables are available"
            echo "  ğŸ¯ Tournament should be able to run"
          else
            echo "  âŒ Missing critical environment variables"
            echo "  ğŸ”§ This is why the tournament workflow is failing"
          fi
          
          echo ""
          echo "Next Steps:"
          if [ -n "$METACULUS_TOKEN" ] && [ -n "$OPENROUTER_API_KEY" ]; then
            echo "  ğŸš€ Environment variables are OK - the issue is elsewhere"
            echo "  ğŸ” Check the tournament logic in main.py"
          else
            echo "  ğŸ”§ Fix the missing environment variables in GitHub Secrets"
            echo "  ğŸ“ Go to: https://github.com/GuillotineTools/guillotine-forecasting/settings/secrets/actions"
          fi
# Manual trigger test at Thu Oct  9 02:28:35 PM JST 2025
